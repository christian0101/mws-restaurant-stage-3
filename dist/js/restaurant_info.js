let restaurant,reviews;var map;document.addEventListener("DOMContentLoaded",e=>{DBHelper.registerServiceWorker(),this._toastsView=new Toast,fetchRestaurantFromURL()}),window.initMap=(()=>{self.restaurant&&(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:self.restaurant.latlng,scrollwheel:!1}),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))}),fetchRestaurantFromURL=(()=>{if(self.restaurant)return;const e=getParameterByName("id");if(e)DBHelper.fetchDataById("restaurants",e,(t,n)=>{if(self.restaurant=n,!t||n)DBHelper.fetchReviewsByRestaurantId(e,(e,t)=>{if(self.reviews=t.reverse(),e){this._toastsView.create(e)}fillRestaurantHTML(),Helper.lazyLoad()});else{this._toastsView.create(t)}});else{this._toastsView.create("No restaurant id in URL")}}),fillRestaurantHTML=((e=self.restaurant)=>{fillBreadcrumb();const t=document.getElementsByTagName("head")[0],n=document.createElement("meta");n.setAttribute("name","description"),n.setAttribute("content",`Detailed information about ${e.name}`),t.append(n);const a=document.getElementById("restaurant-name");a.innerHTML=e.name,a.title="restaurant name";const r=document.getElementById("restaurant-address");r.innerHTML=e.address,r.title="restaurant address";const i=DBHelper.imageUrlForRestaurant(e,!0),s=document.getElementById("restaurant-img");s.className="restaurant-img",s.classList.add("lazy"),s.src=i,s.setAttribute("data-src",DBHelper.imageUrlForRestaurant(e)),s.setAttribute("data-srcset",DBHelper.imageSRCSetUrlsForRestaurant(e,["1x","2x"])),s.alt=e.photograph?DBHelper.getPhotoDescription(e):"no picture found";const l=document.getElementById("restaurant-cuisine");l.innerHTML=e.cuisine_type,l.title="restaurant cuisine type",e.operating_hours&&fillRestaurantHoursHTML(),fillSubmitReviewFormHTML(),fillReviewsHTML()}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");for(let n in e){const a=document.createElement("tr"),r=document.createElement("td");r.innerHTML=n,r.className="openhours-day",a.appendChild(r);const i=document.createElement("td");i.innerHTML=e[n],i.className="openhours-time",a.appendChild(i),t.appendChild(a)}}),fillReviewsHTML=((e=self.reviews)=>{const t=document.getElementById("reviews-container"),n=document.createElement("h3");if(n.innerHTML="Reviews",t.appendChild(n),0===e.length){const e=document.createElement("p");return e.innerHTML="No reviews yet!",void t.appendChild(e)}const a=document.getElementById("reviews-list");e.forEach(e=>{a.appendChild(createReviewHTML(e))}),t.appendChild(a)}),createReviewHTML=(e=>{const t=document.createElement("li"),n=document.createElement("p");n.innerHTML=e.name,n.className="review-name",n.title="reviewer's name",t.appendChild(n);const a=document.createElement("p"),r=new Date(e.createdAt).toLocaleDateString("en-us",{month:"long",day:"numeric",year:"numeric"});a.innerHTML=r,a.className="review-date",a.title="date when review was posted",t.appendChild(a);const i=document.createElement("p");i.innerHTML=`Rating: ${e.rating}`,i.className="review-rating",i.title="given rating",t.appendChild(i);const s=document.createElement("p");return s.innerHTML=e.comments,s.className="review-comments",s.title="comments from the reviewer",t.appendChild(s),t}),fillSubmitReviewFormHTML=((e=self.restaurant)=>{const t=document.getElementById("reviews-list"),n=document.createElement("li"),a=document.createElement("form");a.method="POST",a.setAttribute("aria-label","Add review for restaurant");const r=document.createElement("input");r.id="restaurant id",r.name="restaurant_id",r.type="hidden",r.value=e.id,a.appendChild(r);const i=document.createElement("p");i.className="review-name";const s=document.createElement("label");s.innerHTML="* Name:",s.for="uName",s.title="reviewer's name",i.appendChild(s);const l=document.createElement("input");l.id="uName",l.name="name",l.placeholder="Your Name",l.setAttribute("aria-required","true"),l.setAttribute("aria-label","Your name"),s.appendChild(l),a.appendChild(i);const m=document.createElement("p"),d=(new Date).toLocaleDateString("en-us",{month:"long",day:"numeric",year:"numeric"});m.innerHTML=d,m.className="review-date",m.title="date when review is posted",a.appendChild(m);const o=document.createElement("p");o.className="review-rating";const c=document.createElement("label");c.innerHTML="Rating:";const u=document.createElement("select");u.name="rating";for(var p=1;p<=5;p++){const e=document.createElement("option");e.value=p,e.innerHTML=p,u.appendChild(e)}c.appendChild(u),o.appendChild(c),a.appendChild(o);const h=document.createElement("p");h.className="review-comments";const w=document.createElement("label");w.innerHTML="* Comments:";const g=document.createElement("textarea");g.name="comments",g.id="commentsText",g.setAttribute("aria-required","true"),g.setAttribute("aria-label","Additional comments for the review"),h.appendChild(w),h.appendChild(g),a.appendChild(h);const f=document.createElement("p"),v=document.createElement("button");v.id="submitBtn",v.type="submit",v.innerHTML="Submit Review!",v.value="Submit",v.setAttribute("aria-label","Submit review"),f.appendChild(v),a.appendChild(f),n.appendChild(a),t.appendChild(n)}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),n=document.createElement("li");n.setAttribute("aria-current","page"),n.innerHTML=e.name,t.appendChild(n)}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwicmV2aWV3cyIsIm1hcCIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiREJIZWxwZXIiLCJyZWdpc3RlclNlcnZpY2VXb3JrZXIiLCJ0aGlzIiwiX3RvYXN0c1ZpZXciLCJUb2FzdCIsImZldGNoUmVzdGF1cmFudEZyb21VUkwiLCJ3aW5kb3ciLCJpbml0TWFwIiwic2VsZiIsImdvb2dsZSIsIm1hcHMiLCJNYXAiLCJnZXRFbGVtZW50QnlJZCIsInpvb20iLCJjZW50ZXIiLCJsYXRsbmciLCJzY3JvbGx3aGVlbCIsIm1hcE1hcmtlckZvclJlc3RhdXJhbnQiLCJpZCIsImdldFBhcmFtZXRlckJ5TmFtZSIsImZldGNoRGF0YUJ5SWQiLCJlcnJvciIsImZldGNoUmV2aWV3c0J5UmVzdGF1cmFudElkIiwicmV2ZXJzZSIsImNyZWF0ZSIsImZpbGxSZXN0YXVyYW50SFRNTCIsIkhlbHBlciIsImxhenlMb2FkIiwiZmlsbEJyZWFkY3J1bWIiLCJoZWFkIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJkZXNjcmlwdGlvbiIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJuYW1lIiwiYXBwZW5kIiwiaW5uZXJIVE1MIiwidGl0bGUiLCJhZGRyZXNzIiwiaW1nU3JjIiwiaW1hZ2VVcmxGb3JSZXN0YXVyYW50IiwiaW1hZ2UiLCJjbGFzc05hbWUiLCJjbGFzc0xpc3QiLCJhZGQiLCJzcmMiLCJpbWFnZVNSQ1NldFVybHNGb3JSZXN0YXVyYW50IiwiYWx0IiwiZ2V0UGhvdG9EZXNjcmlwdGlvbiIsImN1aXNpbmUiLCJjdWlzaW5lX3R5cGUiLCJvcGVyYXRpbmdfaG91cnMiLCJmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCIsImZpbGxTdWJtaXRSZXZpZXdGb3JtSFRNTCIsImZpbGxSZXZpZXdzSFRNTCIsIm9wZXJhdGluZ0hvdXJzIiwiaG91cnMiLCJrZXkiLCJyb3ciLCJkYXkiLCJhcHBlbmRDaGlsZCIsInRpbWUiLCJjb250YWluZXIiLCJsZW5ndGgiLCJub1Jldmlld3MiLCJ1bCIsImZvckVhY2giLCJyZXZpZXciLCJjcmVhdGVSZXZpZXdIVE1MIiwibGkiLCJkYXRlIiwiY3JlYXRlZEF0IiwiRGF0ZSIsInRvTG9jYWxlRGF0ZVN0cmluZyIsIm1vbnRoIiwieWVhciIsInJhdGluZyIsImNvbW1lbnRzIiwiZm9ybSIsIm1ldGhvZCIsInJlc3RhdXJhbnRJRCIsInR5cGUiLCJ2YWx1ZSIsIm5hbWVTaGVsbCIsIm5hbWVMYmwiLCJmb3IiLCJuYW1lSW5wdXQiLCJwbGFjZWhvbGRlciIsIm5vdyIsInJhdGluZ1NoZWxsIiwicmF0aW5nTGJsIiwicmF0aW5nT3B0aW9ucyIsImkiLCJvcHRpb24iLCJjb21tZW50c1NoZWxsIiwiY29tbWVudHNMYmwiLCJjb21tZW50c1RleHQiLCJzdWJtaXRTaGVsbCIsInN1Ym1pdEJ0biIsImJyZWFkY3J1bWIiLCJ1cmwiLCJsb2NhdGlvbiIsImhyZWYiLCJyZXBsYWNlIiwicmVzdWx0cyIsIlJlZ0V4cCIsImV4ZWMiLCJkZWNvZGVVUklDb21wb25lbnQiXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLFdBQVlDLFFBQ2hCLElBQUlDLElBS0pDLFNBQVNDLGlCQUFpQixtQkFBcUJDLElBQzdDQyxTQUFTQyx3QkFDVEMsS0FBS0MsWUFBYyxJQUFJQyxNQUN2QkMsMkJBT0ZDLE9BQU9DLFFBQVUsTUFDWEMsS0FBS2QsYUFDUGMsS0FBS1osSUFBTSxJQUFJYSxPQUFPQyxLQUFLQyxJQUFJZCxTQUFTZSxlQUFlLE9BQVEsQ0FDN0RDLEtBQU0sR0FDTkMsT0FBUU4sS0FBS2QsV0FBV3FCLE9BQ3hCQyxhQUFhLElBRWZoQixTQUFTaUIsdUJBQXVCVCxLQUFLZCxXQUFZYyxLQUFLWixRQU8xRFMsdUJBQXlCLE1BQ3ZCLEdBQUlHLEtBQUtkLFdBRVAsT0FFRixNQUFNd0IsRUFBS0MsbUJBQW1CLE1BQzlCLEdBQUtELEVBS0hsQixTQUFTb0IsY0FB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QUFjLFlBQzVDZ0UsRUFBYTlELEtBQU8sV0FDcEI4RCxFQUFhOUUsR0FBSyxlQUNsQjhFLEVBQWEvRCxhQUFhLGdCQUFpQixRQUMzQytELEVBQWEvRCxhQUFhLGFBQWMsc0NBQ3hDNkQsRUFBY2xDLFlBQVltQyxHQUMxQkQsRUFBY2xDLFlBQVlvQyxHQUMxQmxCLEVBQUtsQixZQUFZa0MsR0FFakIsTUFBTUcsRUFBY3BHLFNBQVNtQyxjQUFjLEtBQ3JDa0UsRUFBWXJHLFNBQVNtQyxjQUFjLFVBQ3pDa0UsRUFBVWhGLEdBQUssWUFDZmdGLEVBQVVqQixLQUFPLFNBQ2pCaUIsRUFBVTlELFVBQVksaUJBQ3RCOEQsRUFBVWhCLE1BQVEsU0FDbEJnQixFQUFVakUsYUFBYSxhQUFjLGlCQUNyQ2dFLEVBQVlyQyxZQUFZc0MsR0FDeEJwQixFQUFLbEIsWUFBWXFDLEdBRWpCNUIsRUFBR1QsWUFBWWtCLEdBQ2ZiLEVBQUdMLFlBQVlTLEtBTWpCekMsZUFBaUIsRUFBQ2xDLEVBQWFjLEtBQUtkLGNBQ2xDLE1BQU15RyxFQUFhdEcsU0FBU2UsZUFBZSxjQUNyQ3lELEVBQUt4RSxTQUFTbUMsY0FBYyxNQUNsQ3FDLEVBQUdwQyxhQUFhLGVBQWdCLFFBQ2hDb0MsRUFBR2pDLFVBQVkxQyxFQUFXd0MsS0FDMUJpRSxFQUFXdkMsWUFBWVMsS0FNekJsRCxtQkFBcUIsRUFBQ2UsRUFBTWtFLEtBQ3JCQSxJQUNIQSxFQUFNOUYsT0FBTytGLFNBQVNDLE1BQ3hCcEUsRUFBT0EsRUFBS3FFLFFBQVEsVUFBVyxRQUMvQixNQUNFQyxFQURZLElBQUlDLGNBQWN2RSxzQkFDZHdFLEtBQUtOLEdBQ3ZCLE9BQUtJLEVBRUFBLEVBQVEsR0FFTkcsbUJBQW1CSCxFQUFRLEdBQUdELFFBQVEsTUFBTyxNQUQzQyxHQUZBIiwiZmlsZSI6InJlc3RhdXJhbnRfaW5mby5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCByZXN0YXVyYW50LCByZXZpZXdzO1xudmFyIG1hcDtcblxuLyoqXG4gKiBGZXRjaCBkYXRhIGFzIHNvb24gYXMgdGhlIHBhZ2UgaXMgbG9hZGVkLlxuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKGV2ZW50KSA9PiB7XG4gIERCSGVscGVyLnJlZ2lzdGVyU2VydmljZVdvcmtlcigpO1xuICB0aGlzLl90b2FzdHNWaWV3ID0gbmV3IFRvYXN0KCk7XG4gIGZldGNoUmVzdGF1cmFudEZyb21VUkwoKTtcbn0pO1xuXG5cbi8qKlxuICogSW5pdGlhbGl6ZSBHb29nbGUgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxuICovXG53aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcbiAgaWYgKHNlbGYucmVzdGF1cmFudCkge1xuICAgIHNlbGYubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIHtcbiAgICAgIHpvb206IDE2LFxuICAgICAgY2VudGVyOiBzZWxmLnJlc3RhdXJhbnQubGF0bG5nLFxuICAgICAgc2Nyb2xsd2hlZWw6IGZhbHNlXG4gICAgfSk7XG4gICAgREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubWFwKTtcbiAgfVxufVxuXG4vKipcbiAqIEdldCBjdXJyZW50IHJlc3RhdXJhbnQgZnJvbSBwYWdlIFVSTC5cbiAqL1xuZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCA9ICgpID0+IHtcbiAgaWYgKHNlbGYucmVzdGF1cmFudCkgeyAvLyByZXN0YXVyYW50IGFscmVhZHkgZmV0Y2hlZCFcbiAgICAvL2NhbGxiYWNrKG51bGwsIHNlbGYucmVzdGF1cmFudClcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgaWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJyk7XG4gIGlmICghaWQpIHtcbiAgICAvLyBubyBpZCBmb3VuZCBpbiBVUkxcbiAgICBjb25zdCBlcnJvciA9IHRoaXMuX3RvYXN0c1ZpZXcuY3JlYXRlKCdObyByZXN0YXVyYW50IGlkIGluIFVSTCcpO1xuICAgIHJldHVybjtcbiAgfSBlbHNlIHtcbiAgICBEQkhlbHBlci5mZXRjaERhdGFCeUlkKCdyZXN0YXVyYW50cycsIGlkLCAoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcbiAgICAgIHNlbGYucmVzdGF1cmFudCA9IHJlc3RhdXJhbnQ7XG4gICAgICBpZiAoZXJyb3IgJiYgIXJlc3RhdXJhbnQpIHtcbiAgICAgICAgY29uc3QgbmV0d29ya1dhcm5pbmcgPSB0aGlzLl90b2FzdHNWaWV3LmNyZWF0ZShlcnJvcik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgREJIZWxwZXIuZmV0Y2hSZXZpZXdzQnlSZXN0YXVyYW50SWQoaWQsIChlcnJvciwgcmV2aWV3cykgPT4ge1xuICAgICAgICBzZWxmLnJldmlld3MgPSByZXZpZXdzLnJldmVyc2UoKTtcbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgY29uc3QgbmV0d29ya1dhcm5pbmcgPSB0aGlzLl90b2FzdHNWaWV3LmNyZWF0ZShlcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICBmaWxsUmVzdGF1cmFudEhUTUwoKTtcbiAgICAgICAgSGVscGVyLmxhenlMb2FkKCk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlXG4gKi9cbmZpbGxSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XG4gIGZpbGxCcmVhZGNydW1iKCk7XG5cbiAgY29uc3QgaGVhZCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF07XG4gIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbWV0YScpO1xuICBkZXNjcmlwdGlvbi5zZXRBdHRyaWJ1dGUoJ25hbWUnLCAnZGVzY3JpcHRpb24nKTtcbiAgZGVzY3JpcHRpb24uc2V0QXR0cmlidXRlKCdjb250ZW50JywgYERldGFpbGVkIGluZm9ybWF0aW9uIGFib3V0ICR7cmVzdGF1cmFudC5uYW1lfWApO1xuICBoZWFkLmFwcGVuZChkZXNjcmlwdGlvbik7XG5cbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LW5hbWUnKTtcbiAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XG4gIG5hbWUudGl0bGUgPSAncmVzdGF1cmFudCBuYW1lJztcblxuICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtYWRkcmVzcycpO1xuICBhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzcztcbiAgYWRkcmVzcy50aXRsZSA9ICdyZXN0YXVyYW50IGFkZHJlc3MnO1xuXG4gIGNvbnN0IGltZ1NyYyA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCB0cnVlKTtcbiAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1pbWcnKTtcbiAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJztcbiAgaW1hZ2UuY2xhc3NMaXN0LmFkZCgnbGF6eScpO1xuICBpbWFnZS5zcmMgPSBpbWdTcmM7XG4gIGltYWdlLnNldEF0dHJpYnV0ZSgnZGF0YS1zcmMnLCBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkpO1xuICBpbWFnZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3Jjc2V0JywgREJIZWxwZXIuaW1hZ2VTUkNTZXRVcmxzRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBbJzF4JywgJzJ4J10pKTtcbiAgaW1hZ2UuYWx0ID0gKHJlc3RhdXJhbnQucGhvdG9ncmFwaCkgPyBEQkhlbHBlci5nZXRQaG90b0Rlc2NyaXB0aW9uKHJlc3RhdXJhbnQpIDpcbiAgJ25vIHBpY3R1cmUgZm91bmQnO1xuXG4gIGNvbnN0IGN1aXNpbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1jdWlzaW5lJyk7XG4gIGN1aXNpbmUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5jdWlzaW5lX3R5cGU7XG4gIGN1aXNpbmUudGl0bGUgPSAncmVzdGF1cmFudCBjdWlzaW5lIHR5cGUnO1xuXG4gIC8vIGZpbGwgb3BlcmF0aW5nIGhvdXJzXG4gIGlmIChyZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vycykge1xuICAgIGZpbGxSZXN0YXVyYW50SG91cnNIVE1MKCk7XG4gIH1cbiAgLy8gZmlsbCBzdWJtaXQgcmV2aWV3IGZvcm1cbiAgZmlsbFN1Ym1pdFJldmlld0Zvcm1IVE1MKCk7XG4gIC8vIGZpbGwgcmV2aWV3c1xuICBmaWxsUmV2aWV3c0hUTUwoKTtcbn1cblxuLyoqXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBvcGVyYXRpbmcgaG91cnMgSFRNTCB0YWJsZSBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxuICovXG5maWxsUmVzdGF1cmFudEhvdXJzSFRNTCA9IChvcGVyYXRpbmdIb3VycyA9IHNlbGYucmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpID0+IHtcbiAgY29uc3QgaG91cnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1ob3VycycpO1xuICBmb3IgKGxldCBrZXkgaW4gb3BlcmF0aW5nSG91cnMpIHtcbiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xuXG4gICAgY29uc3QgZGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcbiAgICBkYXkuaW5uZXJIVE1MID0ga2V5O1xuICAgIGRheS5jbGFzc05hbWUgPSAnb3BlbmhvdXJzLWRheSc7XG4gICAgcm93LmFwcGVuZENoaWxkKGRheSk7XG5cbiAgICBjb25zdCB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcbiAgICB0aW1lLmlubmVySFRNTCA9IG9wZXJhdGluZ0hvdXJzW2tleV07XG4gICAgdGltZS5jbGFzc05hbWUgPSAnb3BlbmhvdXJzLXRpbWUnO1xuICAgIHJvdy5hcHBlbmRDaGlsZCh0aW1lKTtcblxuICAgIGhvdXJzLmFwcGVuZENoaWxkKHJvdyk7XG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYWxsIHJldmlld3MgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmZpbGxSZXZpZXdzSFRNTCA9IChyZXZpZXdzID0gc2VsZi5yZXZpZXdzKSA9PiB7XG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWNvbnRhaW5lcicpO1xuICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XG4gIHRpdGxlLmlubmVySFRNTCA9ICdSZXZpZXdzJztcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRpdGxlKTtcblxuICBpZiAocmV2aWV3cy5sZW5ndGggPT09IDApIHtcbiAgICBjb25zdCBub1Jldmlld3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgbm9SZXZpZXdzLmlubmVySFRNTCA9ICdObyByZXZpZXdzIHlldCEnO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChub1Jldmlld3MpO1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWxpc3QnKTtcbiAgcmV2aWV3cy5mb3JFYWNoKHJldmlldyA9PiB7XG4gICAgdWwuYXBwZW5kQ2hpbGQoY3JlYXRlUmV2aWV3SFRNTChyZXZpZXcpKTtcbiAgfSk7XG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh1bCk7XG59XG5cbi8qKlxuICogQ3JlYXRlIHJldmlldyBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmNyZWF0ZVJldmlld0hUTUwgPSAocmV2aWV3KSA9PiB7XG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgbmFtZS5pbm5lckhUTUwgPSByZXZpZXcubmFtZTtcbiAgbmFtZS5jbGFzc05hbWUgPSAncmV2aWV3LW5hbWUnO1xuICBuYW1lLnRpdGxlID0gXCJyZXZpZXdlcidzIG5hbWVcIjtcbiAgbGkuYXBwZW5kQ2hpbGQobmFtZSk7XG5cbiAgY29uc3QgZGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgY29uc3Qgb3B0aW9ucyA9IHttb250aDogJ2xvbmcnLCBkYXk6ICdudW1lcmljJywgeWVhcjogJ251bWVyaWMnfTtcbiAgY29uc3QgY3JlYXRlZEF0ID0gbmV3IERhdGUocmV2aWV3LmNyZWF0ZWRBdCkudG9Mb2NhbGVEYXRlU3RyaW5nKCdlbi11cycsIG9wdGlvbnMpO1xuICBkYXRlLmlubmVySFRNTCA9IGNyZWF0ZWRBdDtcbiAgZGF0ZS5jbGFzc05hbWUgPSAncmV2aWV3LWRhdGUnO1xuICBkYXRlLnRpdGxlID0gJ2RhdGUgd2hlbiByZXZpZXcgd2FzIHBvc3RlZCc7XG4gIGxpLmFwcGVuZENoaWxkKGRhdGUpO1xuXG4gIGNvbnN0IHJhdGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgcmF0aW5nLmlubmVySFRNTCA9IGBSYXRpbmc6ICR7cmV2aWV3LnJhdGluZ31gO1xuICByYXRpbmcuY2xhc3NOYW1lID0gJ3Jldmlldy1yYXRpbmcnO1xuICByYXRpbmcudGl0bGUgPSAnZ2l2ZW4gcmF0aW5nJztcbiAgbGkuYXBwZW5kQ2hpbGQocmF0aW5nKTtcblxuICBjb25zdCBjb21tZW50cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgY29tbWVudHMuaW5uZXJIVE1MID0gcmV2aWV3LmNvbW1lbnRzO1xuICBjb21tZW50cy5jbGFzc05hbWUgPSAncmV2aWV3LWNvbW1lbnRzJztcbiAgY29tbWVudHMudGl0bGUgPSAnY29tbWVudHMgZnJvbSB0aGUgcmV2aWV3ZXInO1xuICBsaS5hcHBlbmRDaGlsZChjb21tZW50cyk7XG5cbiAgcmV0dXJuIGxpO1xufVxuXG4vKipcbiAqICBDcmVhdGUgYSBIVE1MIHN1Ym1pdCBmb3JtIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmZpbGxTdWJtaXRSZXZpZXdGb3JtSFRNTCA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtbGlzdCcpO1xuXG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Zvcm0nKTtcbiAgZm9ybS5tZXRob2QgPSAnUE9TVCc7XG4gIGZvcm0uc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ0FkZCByZXZpZXcgZm9yIHJlc3RhdXJhbnQnKTtcblxuICBjb25zdCByZXN0YXVyYW50SUQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICByZXN0YXVyYW50SUQuaWQgPSAncmVzdGF1cmFudCBpZCc7XG4gIHJlc3RhdXJhbnRJRC5uYW1lID0gJ3Jlc3RhdXJhbnRfaWQnO1xuICByZXN0YXVyYW50SUQudHlwZSA9ICdoaWRkZW4nO1xuICByZXN0YXVyYW50SUQudmFsdWUgPSByZXN0YXVyYW50LmlkO1xuICBmb3JtLmFwcGVuZENoaWxkKHJlc3RhdXJhbnRJRCk7XG5cbiAgY29uc3QgbmFtZVNoZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBuYW1lU2hlbGwuY2xhc3NOYW1lID0gJ3Jldmlldy1uYW1lJztcbiAgY29uc3QgbmFtZUxibCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XG4gIG5hbWVMYmwuaW5uZXJIVE1MID0gJyogTmFtZTonO1xuICBuYW1lTGJsLmZvciA9ICd1TmFtZSc7XG4gIG5hbWVMYmwudGl0bGUgPSBcInJldmlld2VyJ3MgbmFtZVwiO1xuICBuYW1lU2hlbGwuYXBwZW5kQ2hpbGQobmFtZUxibCk7XG5cbiAgY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgbmFtZUlucHV0LmlkID0gJ3VOYW1lJztcbiAgbmFtZUlucHV0Lm5hbWUgPSAnbmFtZSdcbiAgbmFtZUlucHV0LnBsYWNlaG9sZGVyID0gJ1lvdXIgTmFtZSc7XG4gIG5hbWVJbnB1dC5zZXRBdHRyaWJ1dGUoJ2FyaWEtcmVxdWlyZWQnLCAndHJ1ZScpXG4gIG5hbWVJbnB1dC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnWW91ciBuYW1lJyk7XG4gIG5hbWVMYmwuYXBwZW5kQ2hpbGQobmFtZUlucHV0KTtcbiAgZm9ybS5hcHBlbmRDaGlsZChuYW1lU2hlbGwpO1xuXG4gIGNvbnN0IGRhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGNvbnN0IG9wdGlvbnMgPSB7bW9udGg6ICdsb25nJywgZGF5OiAnbnVtZXJpYycsIHllYXI6ICdudW1lcmljJ307XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKCdlbi11cycsIG9wdGlvbnMpO1xuICBkYXRlLmlubmVySFRNTCA9IG5vdztcbiAgZGF0ZS5jbGFzc05hbWUgPSAncmV2aWV3LWRhdGUnO1xuICBkYXRlLnRpdGxlID0gJ2RhdGUgd2hlbiByZXZpZXcgaXMgcG9zdGVkJztcbiAgZm9ybS5hcHBlbmRDaGlsZChkYXRlKTtcblxuICBjb25zdCByYXRpbmdTaGVsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgcmF0aW5nU2hlbGwuY2xhc3NOYW1lID0gJ3Jldmlldy1yYXRpbmcnO1xuICBjb25zdCByYXRpbmdMYmwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpO1xuICByYXRpbmdMYmwuaW5uZXJIVE1MID0gJ1JhdGluZzonO1xuICBjb25zdCByYXRpbmdPcHRpb25zID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2VsZWN0Jyk7XG4gIHJhdGluZ09wdGlvbnMubmFtZSA9ICdyYXRpbmcnO1xuICBmb3IgKHZhciBpID0gMTsgaSA8PSA1OyBpKyspIHtcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICBvcHRpb24udmFsdWUgPSBpO1xuICAgIG9wdGlvbi5pbm5lckhUTUwgPSBpO1xuICAgIHJhdGluZ09wdGlvbnMuYXBwZW5kQ2hpbGQob3B0aW9uKTtcbiAgfVxuICByYXRpbmdMYmwuYXBwZW5kQ2hpbGQocmF0aW5nT3B0aW9ucyk7XG4gIHJhdGluZ1NoZWxsLmFwcGVuZENoaWxkKHJhdGluZ0xibCk7XG4gIGZvcm0uYXBwZW5kQ2hpbGQocmF0aW5nU2hlbGwpO1xuXG4gIGNvbnN0IGNvbW1lbnRzU2hlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGNvbW1lbnRzU2hlbGwuY2xhc3NOYW1lID0gJ3Jldmlldy1jb21tZW50cyc7XG4gIGNvbnN0IGNvbW1lbnRzTGJsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTtcbiAgY29tbWVudHNMYmwuaW5uZXJIVE1MID0gJyogQ29tbWVudHM6JztcbiAgY29uc3QgY29tbWVudHNUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGV4dGFyZWEnKTtcbiAgY29tbWVudHNUZXh0Lm5hbWUgPSAnY29tbWVudHMnO1xuICBjb21tZW50c1RleHQuaWQgPSAnY29tbWVudHNUZXh0JztcbiAgY29tbWVudHNUZXh0LnNldEF0dHJpYnV0ZSgnYXJpYS1yZXF1aXJlZCcsICd0cnVlJylcbiAgY29tbWVudHNUZXh0LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdBZGRpdGlvbmFsIGNvbW1lbnRzIGZvciB0aGUgcmV2aWV3Jyk7XG4gIGNvbW1lbnRzU2hlbGwuYXBwZW5kQ2hpbGQoY29tbWVudHNMYmwpO1xuICBjb21tZW50c1NoZWxsLmFwcGVuZENoaWxkKGNvbW1lbnRzVGV4dCk7XG4gIGZvcm0uYXBwZW5kQ2hpbGQoY29tbWVudHNTaGVsbCk7XG5cbiAgY29uc3Qgc3VibWl0U2hlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICBzdWJtaXRCdG4uaWQgPSAnc3VibWl0QnRuJztcbiAgc3VibWl0QnRuLnR5cGUgPSAnc3VibWl0JztcbiAgc3VibWl0QnRuLmlubmVySFRNTCA9ICdTdWJtaXQgUmV2aWV3ISc7XG4gIHN1Ym1pdEJ0bi52YWx1ZSA9ICdTdWJtaXQnO1xuICBzdWJtaXRCdG4uc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ1N1Ym1pdCByZXZpZXcnKTtcbiAgc3VibWl0U2hlbGwuYXBwZW5kQ2hpbGQoc3VibWl0QnRuKTtcbiAgZm9ybS5hcHBlbmRDaGlsZChzdWJtaXRTaGVsbCk7XG5cbiAgbGkuYXBwZW5kQ2hpbGQoZm9ybSk7XG4gIHVsLmFwcGVuZENoaWxkKGxpKTtcbn1cblxuLyoqXG4gKiBBZGQgcmVzdGF1cmFudCBuYW1lIHRvIHRoZSBicmVhZGNydW1iIG5hdmlnYXRpb24gbWVudVxuICovXG5maWxsQnJlYWRjcnVtYiA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XG4gIGNvbnN0IGJyZWFkY3J1bWIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnJlYWRjcnVtYicpO1xuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gIGxpLnNldEF0dHJpYnV0ZSgnYXJpYS1jdXJyZW50JywgJ3BhZ2UnKVxuICBsaS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XG4gIGJyZWFkY3J1bWIuYXBwZW5kQ2hpbGQobGkpO1xufVxuXG4vKipcbiAqIEdldCBhIHBhcmFtZXRlciBieSBuYW1lIGZyb20gcGFnZSBVUkwuXG4gKi9cbmdldFBhcmFtZXRlckJ5TmFtZSA9IChuYW1lLCB1cmwpID0+IHtcbiAgaWYgKCF1cmwpXG4gICAgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG4gIG5hbWUgPSBuYW1lLnJlcGxhY2UoL1tcXFtcXF1dL2csICdcXFxcJCYnKTtcbiAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBbPyZdJHtuYW1lfSg9KFteJiNdKil8JnwjfCQpYCksXG4gICAgcmVzdWx0cyA9IHJlZ2V4LmV4ZWModXJsKTtcbiAgaWYgKCFyZXN1bHRzKVxuICAgIHJldHVybiBudWxsO1xuICBpZiAoIXJlc3VsdHNbMl0pXG4gICAgcmV0dXJuICcnO1xuICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHJlc3VsdHNbMl0ucmVwbGFjZSgvXFwrL2csICcgJykpO1xufVxuIl19
