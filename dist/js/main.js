let restaurants,neighborhoods,cuisines;var map,markers=[];document.addEventListener("DOMContentLoaded",e=>{DBHelper.registerServiceWorker(),this._toastsView=new Toast,this._dbPromise=DBHelper.openDatabase(),fetchNeighborhoods(),fetchCuisines(),updateRestaurants()}),showNotification=((e,t,s)=>{this._toastsView.create(e,t,s)}),fetchNeighborhoods=(()=>{DBHelper.fetchNeighborhoods(this._dbPromise,(e,t)=>{e&&(showNotification(e),!t)||(self.neighborhoods=t,fillNeighborhoodsHTML())})}),fillNeighborhoodsHTML=((e=self.neighborhoods)=>{const t=document.getElementById("neighborhoods-select");e.forEach(e=>{const s=document.createElement("option");s.innerHTML=e,s.value=e,t.append(s)})}),fetchCuisines=(()=>{DBHelper.fetchCuisines(this._dbPromise,(e,t)=>{e&&(showNotification(e),!t)||(self.cuisines=t,fillCuisinesHTML())})}),fillCuisinesHTML=((e=self.cuisines)=>{const t=document.getElementById("cuisines-select");e.forEach(e=>{const s=document.createElement("option");s.innerHTML=e,s.value=e,t.append(s)})}),window.initMap=(()=>{self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),self.restaurants&&addMarkersToMap()}),updateRestaurants=(()=>{const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),s=e.selectedIndex,n=t.selectedIndex,a=e[s].value,r=t[n].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(a,r,this._dbPromise,(e,t)=>{e&&(showNotification(e),!t)||(resetRestaurants(t),fillRestaurantsHTML(),Helper.lazyLoad())})}),resetRestaurants=(e=>{self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(e=>e.setMap(null)),self.markers=[],self.restaurants=e}),fillRestaurantsHTML=((e=self.restaurants)=>{const t=document.getElementById("restaurants-list");if(0===e.length){const e=document.createElement("p");return e.innerHTML="Could not find any restaurants :(",void t.appendChild(e)}e.forEach(e=>{t.append(createRestaurantHTML(e))})}),createRestaurantHTML=(e=>{const t=document.createElement("li"),s=DBHelper.imageUrlForRestaurant(e,!0),n=document.createElement("img");n.className="restaurant-img",n.classList.add("lazy"),n.src=s,n.setAttribute("data-src",DBHelper.imageUrlForRestaurant(e)),n.setAttribute("data-srcset",DBHelper.imageSRCSetUrlsForRestaurant(e,["1x","2x"])),n.alt=e.photograph?DBHelper.getPhotoDescription(e):"no picture found",t.append(n);const a=document.createElement("h3");a.innerHTML=e.name,a.title="restaurant name",t.append(a);const r=document.createElement("p");r.innerHTML=e.neighborhood,r.title="restaurant neighborhood",t.append(r);const o=document.createElement("p");o.innerHTML=e.address,o.title="restaurant address",t.append(o);const i=document.createElement("a");return i.innerHTML=`View More about ${e.name}`,i.title=`More details about the resturant ${e.name}`,i.href=DBHelper.urlForRestaurant(e),t.append(i),t}),addMarkersToMap=((e=self.restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",()=>{window.location.href=t.url}),self.markers.push(t)})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicmVzdGF1cmFudHMiLCJuZWlnaGJvcmhvb2RzIiwiY3Vpc2luZXMiLCJtYXAiLCJtYXJrZXJzIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJEQkhlbHBlciIsInJlZ2lzdGVyU2VydmljZVdvcmtlciIsInRoaXMiLCJfdG9hc3RzVmlldyIsIlRvYXN0IiwiX2RiUHJvbWlzZSIsIm9wZW5EYXRhYmFzZSIsImZldGNoTmVpZ2hib3Job29kcyIsImZldGNoQ3Vpc2luZXMiLCJ1cGRhdGVSZXN0YXVyYW50cyIsInNob3dOb3RpZmljYXRpb24iLCJtc2ciLCJkdXJhdGlvbiIsIm9wdGlvbnMiLCJjcmVhdGUiLCJlcnJvciIsInNlbGYiLCJmaWxsTmVpZ2hib3Job29kc0hUTUwiLCJzZWxlY3QiLCJnZXRFbGVtZW50QnlJZCIsImZvckVhY2giLCJuZWlnaGJvcmhvb2QiLCJvcHRpb24iLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwidmFsdWUiLCJhcHBlbmQiLCJmaWxsQ3Vpc2luZXNIVE1MIiwiY3Vpc2luZSIsIndpbmRvdyIsImluaXRNYXAiLCJnb29nbGUiLCJtYXBzIiwiTWFwIiwiem9vbSIsImNlbnRlciIsImxhdCIsImxuZyIsInNjcm9sbHdoZWVsIiwiYWRkTWFya2Vyc1RvTWFwIiwiY1NlbGVjdCIsIm5TZWxlY3QiLCJjSW5kZXgiLCJzZWxlY3RlZEluZGV4IiwibkluZGV4IiwiZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kIiwicmVzZXRSZXN0YXVyYW50cyIsImZpbGxSZXN0YXVyYW50c0hUTUwiLCJIZWxwZXIiLCJsYXp5TG9hZCIsIm0iLCJzZXRNYXAiLCJ1bCIsImxlbmd0aCIsIm5vUmVzdGF1cmFudHMiLCJhcHBlbmRDaGlsZCIsInJlc3RhdXJhbnQiLCJjcmVhdGVSZXN0YXVyYW50SFRNTCIsImxpIiwiaW1nU3JjIiwiaW1hZ2VVcmxGb3JSZXN0YXVyYW50IiwiaW1hZ2UiLCJjbGFzc05hbWUiLCJjbGFzc0xpc3QiLCJhZGQiLCJzcmMiLCJzZXRBdHRyaWJ1dGUiLCJpbWFnZVNSQ1NldFVybHNGb3JSZXN0YXVyYW50IiwiYWx0IiwiZ2V0UGhvdG9EZXNjcmlwdGlvbiIsIm5hbWUiLCJ0aXRsZSIsImFkZHJlc3MiLCJtb3JlIiwiaHJlZiIsInVybEZvclJlc3RhdXJhbnQiLCJtYXJrZXIiLCJtYXBNYXJrZXJGb3JSZXN0YXVyYW50IiwiYWRkTGlzdGVuZXIiLCJsb2NhdGlvbiIsInVybCIsInB1c2giXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLFlBQWFDLGNBQWVDLFNBQ2hDLElBQUlDLElBQ0FDLFFBQVUsR0FLZEMsU0FBU0MsaUJBQWlCLG1CQUFxQkMsSUFDN0NDLFNBQVNDLHdCQUNUQyxLQUFLQyxZQUFjLElBQUlDLE1BQ3ZCRixLQUFLRyxXQUFhTCxTQUFTTSxlQUMzQkMscUJBQ0FDLGdCQUNBQyxzQkFNRkMsaUJBQW1CLEVBQUNDLEVBQUtDLEVBQVVDLEtBQ2hDWCxLQUFLQyxZQUFZVyxPQUFPSCxFQUFLQyxFQUFVQyxLQU0xQ04sbUJBQXFCLE1BQ25CUCxTQUFTTyxtQkFBbUJMLEtBQUtHLFdBQVksQ0FBQ1UsRUFBT3RCLEtBQy9Dc0IsSUFDRkwsaUJBQWlCSyxJQUNadEIsS0FJUHVCLEtBQUt2QixjQUFnQkEsRUFDckJ3Qiw2QkFPSkEsc0JBQXdCLEVBQUN4QixFQUFnQnVCLEtBQUt2QixpQkFDNUMsTUFBTXlCLEVBQVNyQixTQUFTc0IsZUFBZSx3QkFDdkMxQixFQUFjMkIsUUFBUUMsSUFDcEIsTUFBTUMsRUFBU3pCLFNBQVMwQixjQUFjLFVBQ3RDRCxFQUFPRSxVQUFZSCxFQUNuQkMsRUFBT0csTUFBUUosRUFDZkgsRUFBT1EsT0FBT0osT0FPbEJkLGNBQWdCLE1BQ2RSLFNBQVNRLGNBQWNOLEtBQUtHLFdBQVksQ0FBQ1UsRUFBT3JCLEtBQzFDcUIsSUFDRkwsaUJBQWlCSyxJQUNackIsS0FJUHNCLEtBQUt0QixTQUFXQSxFQUNoQmlDLHdC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SGYsSUFNVG5CLGdCQUFrQixFQUFDL0MsRUFBY3dCLEtBQUt4QixlQUNwQ0EsRUFBWTRCLFFBQVFvQyxJQUVsQixNQUFNb0IsRUFBUzVFLFNBQVM2RSx1QkFBdUJyQixFQUFZeEMsS0FBS3JCLEtBQ2hFb0MsT0FBT0MsS0FBS2pDLE1BQU0rRSxZQUFZRixFQUFRLFFBQVMsS0FDN0MvQyxPQUFPa0QsU0FBU0wsS0FBT0UsRUFBT0ksTUFHaENoRSxLQUFLcEIsUUFBUXFGLEtBQUtMIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgcmVzdGF1cmFudHMsIG5laWdoYm9yaG9vZHMsIGN1aXNpbmVzO1xyXG52YXIgbWFwO1xyXG52YXIgbWFya2VycyA9IFtdO1xyXG5cclxuLyoqXHJcbiAqIEZldGNoIGRhdGEgYXMgc29vbiBhcyB0aGUgcGFnZSBpcyBsb2FkZWQuXHJcbiAqL1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKGV2ZW50KSA9PiB7XHJcbiAgREJIZWxwZXIucmVnaXN0ZXJTZXJ2aWNlV29ya2VyKCk7XHJcbiAgdGhpcy5fdG9hc3RzVmlldyA9IG5ldyBUb2FzdCgpO1xyXG4gIHRoaXMuX2RiUHJvbWlzZSA9IERCSGVscGVyLm9wZW5EYXRhYmFzZSgpO1xyXG4gIGZldGNoTmVpZ2hib3Job29kcygpO1xyXG4gIGZldGNoQ3Vpc2luZXMoKTtcclxuICB1cGRhdGVSZXN0YXVyYW50cygpO1xyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBEaXNwbGF5IG5vdGlmaWNhdGlvbnMuXHJcbiAqL1xyXG5zaG93Tm90aWZpY2F0aW9uID0gKG1zZywgZHVyYXRpb24sIG9wdGlvbnMpID0+IHtcclxuICAgdGhpcy5fdG9hc3RzVmlldy5jcmVhdGUobXNnLCBkdXJhdGlvbiwgb3B0aW9ucyk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBGZXRjaCBhbGwgbmVpZ2hib3Job29kcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiAqL1xyXG5mZXRjaE5laWdoYm9yaG9vZHMgPSAoKSA9PiB7XHJcbiAgREJIZWxwZXIuZmV0Y2hOZWlnaGJvcmhvb2RzKHRoaXMuX2RiUHJvbWlzZSwgKGVycm9yLCBuZWlnaGJvcmhvb2RzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yXHJcbiAgICAgIHNob3dOb3RpZmljYXRpb24oZXJyb3IpO1xyXG4gICAgICBpZiAoIW5laWdoYm9yaG9vZHMpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHNlbGYubmVpZ2hib3Job29kcyA9IG5laWdoYm9yaG9vZHM7XHJcbiAgICBmaWxsTmVpZ2hib3Job29kc0hUTUwoKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCBuZWlnaGJvcmhvb2RzIEhUTUwuXHJcbiAqL1xyXG5maWxsTmVpZ2hib3Job29kc0hUTUwgPSAobmVpZ2hib3Job29kcyA9IHNlbGYubmVpZ2hib3Job29kcykgPT4ge1xyXG4gIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xyXG4gIG5laWdoYm9yaG9vZHMuZm9yRWFjaChuZWlnaGJvcmhvb2QgPT4ge1xyXG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XHJcbiAgICBvcHRpb24uaW5uZXJIVE1MID0gbmVpZ2hib3Job29kO1xyXG4gICAgb3B0aW9uLnZhbHVlID0gbmVpZ2hib3Job29kO1xyXG4gICAgc2VsZWN0LmFwcGVuZChvcHRpb24pO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogRmV0Y2ggYWxsIGN1aXNpbmVzIGFuZCBzZXQgdGhlaXIgSFRNTC5cclxuICovXHJcbmZldGNoQ3Vpc2luZXMgPSAoKSA9PiB7XHJcbiAgREJIZWxwZXIuZmV0Y2hDdWlzaW5lcyh0aGlzLl9kYlByb21pc2UsIChlcnJvciwgY3Vpc2luZXMpID0+IHtcclxuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgIHNob3dOb3RpZmljYXRpb24oZXJyb3IpO1xyXG4gICAgICBpZiAoIWN1aXNpbmVzKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBzZWxmLmN1aXNpbmVzID0gY3Vpc2luZXM7XHJcbiAgICBmaWxsQ3Vpc2luZXNIVE1MKCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXQgY3Vpc2luZXMgSFRNTC5cclxuICovXHJcbmZpbGxDdWlzaW5lc0hUTUwgPSAoY3Vpc2luZXMgPSBzZWxmLmN1aXNpbmVzKSA9PiB7XHJcbiAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmVzLXNlbGVjdCcpO1xyXG5cclxuICBjdWlzaW5lcy5mb3JFYWNoKGN1aXNpbmUgPT4ge1xyXG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XHJcbiAgICBvcHRpb24uaW5uZXJIVE1MID0gY3Vpc2luZTtcclxuICAgIG9wdGlvbi52YWx1ZSA9IGN1aXNpbmU7XHJcbiAgICBzZWxlY3QuYXBwZW5kKG9wdGlvbik7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIEdvb2dsZSBtYXAsIGNhbGxlZCBmcm9tIEhUTUwuXHJcbiAqL1xyXG53aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcclxuICBsZXQgbG9jID0ge1xyXG4gICAgbGF0OiA0MC43MjIyMTYsXHJcbiAgICBsbmc6IC03My45ODc1MDFcclxuICB9O1xyXG4gIHNlbGYubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIHtcclxuICAgIHpvb206IDEyLFxyXG4gICAgY2VudGVyOiBsb2MsXHJcbiAgICBzY3JvbGx3aGVlbDogZmFsc2VcclxuICB9KTtcclxuXHJcbiAgaWYgKHNlbGYucmVzdGF1cmFudHMpIHtcclxuICAgIGFkZE1hcmtlcnNUb01hcCgpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZSBwYWdlIGFuZCBtYXAgZm9yIGN1cnJlbnQgcmVzdGF1cmFudHMuXHJcbiAqL1xyXG51cGRhdGVSZXN0YXVyYW50cyA9ICgpID0+IHtcclxuICBjb25zdCBjU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmVzLXNlbGVjdCcpO1xyXG4gIGNvbnN0IG5TZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKTtcclxuXHJcbiAgY29uc3QgY0luZGV4ID0gY1NlbGVjdC5zZWxlY3RlZEluZGV4O1xyXG4gIGNvbnN0IG5JbmRleCA9IG5TZWxlY3Quc2VsZWN0ZWRJbmRleDtcclxuXHJcbiAgY29uc3QgY3Vpc2luZSA9IGNTZWxlY3RbY0luZGV4XS52YWx1ZTtcclxuICBjb25zdCBuZWlnaGJvcmhvb2QgPSBuU2VsZWN0W25JbmRleF0udmFsdWU7XHJcblxyXG4gIERCSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZChjdWlzaW5lLCBuZWlnaGJvcmhvb2QsIHRoaXMuX2RiUHJvbWlzZSwgKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgc2hvd05vdGlmaWNhdGlvbihlcnJvcik7XHJcbiAgICAgIGlmICghcmVzdGF1cmFudHMpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXNldFJlc3RhdXJhbnRzKHJlc3RhdXJhbnRzKTtcclxuICAgIGZpbGxSZXN0YXVyYW50c0hUTUwoKTtcclxuICAgIEhlbHBlci5sYXp5TG9hZCgpO1xyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDbGVhciBjdXJyZW50IHJlc3RhdXJhbnRzLCB0aGVpciBIVE1MIGFuZCByZW1vdmUgdGhlaXIgbWFwIG1hcmtlcnMuXHJcbiAqL1xyXG5yZXNldFJlc3RhdXJhbnRzID0gKHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgLy8gUmVtb3ZlIGFsbCByZXN0YXVyYW50c1xyXG4gIHNlbGYucmVzdGF1cmFudHMgPSBbXTtcclxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XHJcbiAgdWwuaW5uZXJIVE1MID0gJyc7XHJcblxyXG4gIC8vIFJlbW92ZSBhbGwgbWFwIG1hcmtlcnNcclxuICBzZWxmLm1hcmtlcnMuZm9yRWFjaChtID0+IG0uc2V0TWFwKG51bGwpKTtcclxuICBzZWxmLm1hcmtlcnMgPSBbXTtcclxuICBzZWxmLnJlc3RhdXJhbnRzID0gcmVzdGF1cmFudHM7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgYWxsIHJlc3RhdXJhbnRzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuZmlsbFJlc3RhdXJhbnRzSFRNTCA9IChyZXN0YXVyYW50cyA9IHNlbGYucmVzdGF1cmFudHMpID0+IHtcclxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XHJcblxyXG4gIGlmIChyZXN0YXVyYW50cy5sZW5ndGggPT09IDApIHtcclxuICAgIGNvbnN0IG5vUmVzdGF1cmFudHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgICBub1Jlc3RhdXJhbnRzLmlubmVySFRNTCA9IGBDb3VsZCBub3QgZmluZCBhbnkgcmVzdGF1cmFudHMgOihgO1xyXG4gICAgdWwuYXBwZW5kQ2hpbGQobm9SZXN0YXVyYW50cyk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xyXG4gICAgdWwuYXBwZW5kKGNyZWF0ZVJlc3RhdXJhbnRIVE1MKHJlc3RhdXJhbnQpKTtcclxuICB9KTtcclxuICAvL2FkZE1hcmtlcnNUb01hcCgpO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTC5cclxuICovXHJcbmNyZWF0ZVJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQpID0+IHtcclxuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcblxyXG4gIGNvbnN0IGltZ1NyYyA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCB0cnVlKTtcclxuICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XHJcbiAgaW1hZ2UuY2xhc3NMaXN0LmFkZCgnbGF6eScpO1xyXG4gIGltYWdlLnNyYyA9IGltZ1NyYztcclxuICBpbWFnZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3JjJywgREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpKTtcclxuICBpbWFnZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3Jjc2V0JywgREJIZWxwZXIuaW1hZ2VTUkNTZXRVcmxzRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBbJzF4JywgJzJ4J10pKTtcclxuICBpbWFnZS5hbHQgPSAocmVzdGF1cmFudC5waG90b2dyYXBoKSA/IERCSGVscGVyLmdldFBob3RvRGVzY3JpcHRpb24ocmVzdGF1cmFudCkgOlxyXG4gICdubyBwaWN0dXJlIGZvdW5kJztcclxuICBsaS5hcHBlbmQoaW1hZ2UpO1xyXG5cclxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcclxuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcclxuICBuYW1lLnRpdGxlID0gJ3Jlc3RhdXJhbnQgbmFtZSc7XHJcbiAgbGkuYXBwZW5kKG5hbWUpO1xyXG5cclxuICBjb25zdCBuZWlnaGJvcmhvb2QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgbmVpZ2hib3Job29kLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmVpZ2hib3Job29kO1xyXG4gIG5laWdoYm9yaG9vZC50aXRsZSA9ICdyZXN0YXVyYW50IG5laWdoYm9yaG9vZCc7XHJcbiAgbGkuYXBwZW5kKG5laWdoYm9yaG9vZCk7XHJcblxyXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XHJcbiAgYWRkcmVzcy50aXRsZSA9ICdyZXN0YXVyYW50IGFkZHJlc3MnO1xyXG4gIGxpLmFwcGVuZChhZGRyZXNzKTtcclxuXHJcbiAgY29uc3QgbW9yZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICBtb3JlLmlubmVySFRNTCA9IGBWaWV3IE1vcmUgYWJvdXQgJHtyZXN0YXVyYW50Lm5hbWV9YDtcclxuICBtb3JlLnRpdGxlID0gYE1vcmUgZGV0YWlscyBhYm91dCB0aGUgcmVzdHVyYW50ICR7cmVzdGF1cmFudC5uYW1lfWA7XHJcbiAgbW9yZS5ocmVmID0gREJIZWxwZXIudXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcclxuICBsaS5hcHBlbmQobW9yZSlcclxuXHJcbiAgcmV0dXJuIGxpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBZGQgbWFya2VycyBmb3IgY3VycmVudCByZXN0YXVyYW50cyB0byB0aGUgbWFwLlxyXG4gKi9cclxuYWRkTWFya2Vyc1RvTWFwID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xyXG4gIHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XHJcbiAgICAvLyBBZGQgbWFya2VyIHRvIHRoZSBtYXBcclxuICAgIGNvbnN0IG1hcmtlciA9IERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgc2VsZi5tYXApO1xyXG4gICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAnY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gbWFya2VyLnVybFxyXG4gICAgfSk7XHJcblxyXG4gICAgc2VsZi5tYXJrZXJzLnB1c2gobWFya2VyKTtcclxuICB9KTtcclxufVxyXG4iXX0=
