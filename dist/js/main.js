let restaurants,neighborhoods,cuisines;var map,markers=[];document.addEventListener("DOMContentLoaded",e=>{DBHelper.registerServiceWorker(),this._toastsView=new Toast,fetchNeighborhoods(),fetchCuisines(),updateRestaurants()}),showNotification=((e,t={buttons:["dismiss"]})=>{this._toastsView.create(e,t)}),fetchNeighborhoods=(()=>{DBHelper.fetchNeighborhoods((e,t)=>{e&&(showNotification(e),!t)||(self.neighborhoods=t,fillNeighborhoodsHTML())})}),fillNeighborhoodsHTML=((e=self.neighborhoods)=>{const t=document.getElementById("neighborhoods-select");e.forEach(e=>{const s=document.createElement("option");s.innerHTML=e,s.value=e,t.append(s)})}),fetchCuisines=(()=>{DBHelper.fetchCuisines((e,t)=>{e&&(showNotification(e),!t)||(self.cuisines=t,fillCuisinesHTML())})}),fillCuisinesHTML=((e=self.cuisines)=>{const t=document.getElementById("cuisines-select");e.forEach(e=>{const s=document.createElement("option");s.innerHTML=e,s.value=e,t.append(s)})}),window.initMap=(()=>{self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),self.restaurants&&addMarkersToMap()}),updateRestaurants=(()=>{const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),s=e.selectedIndex,n=t.selectedIndex,a=e[s].value,r=t[n].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(a,r,(e,t)=>{e&&(showNotification(e),!t)||(resetRestaurants(t),fillRestaurantsHTML(),Helper.lazyLoad())})}),resetRestaurants=(e=>{self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(e=>e.setMap(null)),self.markers=[],self.restaurants=e}),fillRestaurantsHTML=((e=self.restaurants)=>{const t=document.getElementById("restaurants-list");if(0===e.length){const e=document.createElement("p");return e.innerHTML="Could not find any restaurants :(",void t.appendChild(e)}e.forEach(e=>{t.append(createRestaurantHTML(e))})}),createRestaurantHTML=(e=>{const t=document.createElement("li"),s=DBHelper.imageUrlForRestaurant(e,!0),n=document.createElement("img");n.className="restaurant-img",n.classList.add("lazy"),n.src=s,n.setAttribute("data-src",DBHelper.imageUrlForRestaurant(e)),n.setAttribute("data-srcset",DBHelper.imageSRCSetUrlsForRestaurant(e,["1x","2x"])),n.alt=e.photograph?DBHelper.getPhotoDescription(e):"no picture found",t.append(n);const a=document.createElement("h3");a.innerHTML=e.name,a.title="restaurant name",t.append(a);const r=document.createElement("p");r.innerHTML=e.neighborhood,r.title="restaurant neighborhood",t.append(r);const o=document.createElement("p");o.innerHTML=e.address,o.title="restaurant address",t.append(o);const i=document.createElement("a");return i.innerHTML=`View More about ${e.name}`,i.title=`More details about the resturant ${e.name}`,i.href=DBHelper.urlForRestaurant(e),t.append(i),t}),addMarkersToMap=((e=self.restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",()=>{window.location.href=t.url}),self.markers.push(t)})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicmVzdGF1cmFudHMiLCJuZWlnaGJvcmhvb2RzIiwiY3Vpc2luZXMiLCJtYXAiLCJtYXJrZXJzIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJEQkhlbHBlciIsInJlZ2lzdGVyU2VydmljZVdvcmtlciIsInRoaXMiLCJfdG9hc3RzVmlldyIsIlRvYXN0IiwiZmV0Y2hOZWlnaGJvcmhvb2RzIiwiZmV0Y2hDdWlzaW5lcyIsInVwZGF0ZVJlc3RhdXJhbnRzIiwic2hvd05vdGlmaWNhdGlvbiIsIm1zZyIsIm9wdGlvbnMiLCJidXR0b25zIiwiY3JlYXRlIiwiZXJyb3IiLCJzZWxmIiwiZmlsbE5laWdoYm9yaG9vZHNIVE1MIiwic2VsZWN0IiwiZ2V0RWxlbWVudEJ5SWQiLCJmb3JFYWNoIiwibmVpZ2hib3Job29kIiwib3B0aW9uIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsInZhbHVlIiwiYXBwZW5kIiwiZmlsbEN1aXNpbmVzSFRNTCIsImN1aXNpbmUiLCJ3aW5kb3ciLCJpbml0TWFwIiwiZ29vZ2xlIiwibWFwcyIsIk1hcCIsInpvb20iLCJjZW50ZXIiLCJsYXQiLCJsbmciLCJzY3JvbGx3aGVlbCIsImFkZE1hcmtlcnNUb01hcCIsImNTZWxlY3QiLCJuU2VsZWN0IiwiY0luZGV4Iiwic2VsZWN0ZWRJbmRleCIsIm5JbmRleCIsImZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZCIsInJlc2V0UmVzdGF1cmFudHMiLCJmaWxsUmVzdGF1cmFudHNIVE1MIiwiSGVscGVyIiwibGF6eUxvYWQiLCJtIiwic2V0TWFwIiwidWwiLCJsZW5ndGgiLCJub1Jlc3RhdXJhbnRzIiwiYXBwZW5kQ2hpbGQiLCJyZXN0YXVyYW50IiwiY3JlYXRlUmVzdGF1cmFudEhUTUwiLCJsaSIsImltZ1NyYyIsImltYWdlVXJsRm9yUmVzdGF1cmFudCIsImltYWdlIiwiY2xhc3NOYW1lIiwiY2xhc3NMaXN0IiwiYWRkIiwic3JjIiwic2V0QXR0cmlidXRlIiwiaW1hZ2VTUkNTZXRVcmxzRm9yUmVzdGF1cmFudCIsImFsdCIsImdldFBob3RvRGVzY3JpcHRpb24iLCJuYW1lIiwidGl0bGUiLCJhZGRyZXNzIiwibW9yZSIsImhyZWYiLCJ1cmxGb3JSZXN0YXVyYW50IiwibWFya2VyIiwibWFwTWFya2VyRm9yUmVzdGF1cmFudCIsImFkZExpc3RlbmVyIiwibG9jYXRpb24iLCJ1cmwiLCJwdXNoIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFJQSxZQUNGQyxjQUNBQyxTQUNGLElBQUlDLElBQ0FDLFFBQVUsR0FLZEMsU0FBU0MsaUJBQWlCLG1CQUFxQkMsSUFDN0NDLFNBQVNDLHdCQUNUQyxLQUFLQyxZQUFjLElBQUlDLE1BQ3ZCQyxxQkFDQUMsZ0JBQ0FDLHNCQU1EQyxpQkFBbUIsRUFBQ0MsRUFBS0MsRUFBVSxDQUFDQyxRQUFTLENBQUMsZUFDNUNULEtBQUtDLFlBQVlTLE9BQU9ILEVBQUtDLEtBTWhDTCxtQkFBcUIsTUFDbkJMLFNBQVNLLG1CQUFtQixDQUFDUSxFQUFPcEIsS0FDOUJvQixJQUNGTCxpQkFBaUJLLElBQ1pwQixLQUlQcUIsS0FBS3JCLGNBQWdCQSxFQUNyQnNCLDZCQU9KQSxzQkFBd0IsRUFBQ3RCLEVBQWdCcUIsS0FBS3JCLGlCQUM1QyxNQUFNdUIsRUFBU25CLFNBQVNvQixlQUFlLHdCQUN2Q3hCLEVBQWN5QixRQUFRQyxJQUNwQixNQUFNQyxFQUFTdkIsU0FBU3dCLGNBQWMsVUFDdENELEVBQU9FLFVBQVlILEVBQ25CQyxFQUFPRyxNQUFRSixFQUNmSCxFQUFPUSxPQUFPSixPQU9sQmQsY0FBZ0IsTUFDZE4sU0FBU00sY0FBYyxDQUFDTyxFQUFPbkIsS0FDekJtQixJQUNGTCxpQkFBaUJLLElBQ1puQixLQUlQb0IsS0FBS3BCLFNBQVdBLEVBQ2hCK0Isd0JBT0pBLGlCQUFtQixFQUFDL0IsRUFBV29CLEtBQUtwQixZQUNsQyxNQUFNc0IsRUFBU25CLFNBQVNvQixlQUFlLG1CQUV2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MkUsdUJBQXVCckIsRUFBWXhDLEtBQUtuQixLQUNoRWtDLE9BQU9DLEtBQUsvQixNQUFNNkUsWUFBWUYsRUFBUSxRQUFTLEtBQzdDL0MsT0FBT2tELFNBQVNMLEtBQU9FLEVBQU9JLE1BR2hDaEUsS0FBS2xCLFFBQVFtRixLQUFLTCIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHJlc3RhdXJhbnRzLFxyXG4gIG5laWdoYm9yaG9vZHMsXHJcbiAgY3Vpc2luZXNcclxudmFyIG1hcFxyXG52YXIgbWFya2VycyA9IFtdXHJcblxyXG4vKipcclxuICogRmV0Y2ggZGF0YSBhcyBzb29uIGFzIHRoZSBwYWdlIGlzIGxvYWRlZC5cclxuICovXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoZXZlbnQpID0+IHtcclxuICBEQkhlbHBlci5yZWdpc3RlclNlcnZpY2VXb3JrZXIoKTtcclxuICB0aGlzLl90b2FzdHNWaWV3ID0gbmV3IFRvYXN0KCk7XHJcbiAgZmV0Y2hOZWlnaGJvcmhvb2RzKCk7XHJcbiAgZmV0Y2hDdWlzaW5lcygpO1xyXG4gIHVwZGF0ZVJlc3RhdXJhbnRzKCk7XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIERpc3BsYXkgbm90aWZpY2F0aW9ucy5cclxuICovXHJcbiBzaG93Tm90aWZpY2F0aW9uID0gKG1zZywgb3B0aW9ucyA9IHtidXR0b25zOiBbJ2Rpc21pc3MnXX0pID0+IHtcclxuICAgdGhpcy5fdG9hc3RzVmlldy5jcmVhdGUobXNnLCBvcHRpb25zKTtcclxuIH1cclxuXHJcbi8qKlxyXG4gKiBGZXRjaCBhbGwgbmVpZ2hib3Job29kcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiAqL1xyXG5mZXRjaE5laWdoYm9yaG9vZHMgPSAoKSA9PiB7XHJcbiAgREJIZWxwZXIuZmV0Y2hOZWlnaGJvcmhvb2RzKChlcnJvciwgbmVpZ2hib3Job29kcykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvclxyXG4gICAgICBzaG93Tm90aWZpY2F0aW9uKGVycm9yKTtcclxuICAgICAgaWYgKCFuZWlnaGJvcmhvb2RzKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBzZWxmLm5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzO1xyXG4gICAgZmlsbE5laWdoYm9yaG9vZHNIVE1MKCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXQgbmVpZ2hib3Job29kcyBIVE1MLlxyXG4gKi9cclxuZmlsbE5laWdoYm9yaG9vZHNIVE1MID0gKG5laWdoYm9yaG9vZHMgPSBzZWxmLm5laWdoYm9yaG9vZHMpID0+IHtcclxuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKTtcclxuICBuZWlnaGJvcmhvb2RzLmZvckVhY2gobmVpZ2hib3Job29kID0+IHtcclxuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xyXG4gICAgb3B0aW9uLmlubmVySFRNTCA9IG5laWdoYm9yaG9vZDtcclxuICAgIG9wdGlvbi52YWx1ZSA9IG5laWdoYm9yaG9vZDtcclxuICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEZldGNoIGFsbCBjdWlzaW5lcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiAqL1xyXG5mZXRjaEN1aXNpbmVzID0gKCkgPT4ge1xyXG4gIERCSGVscGVyLmZldGNoQ3Vpc2luZXMoKGVycm9yLCBjdWlzaW5lcykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgc2hvd05vdGlmaWNhdGlvbihlcnJvcik7XHJcbiAgICAgIGlmICghY3Vpc2luZXMpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHNlbGYuY3Vpc2luZXMgPSBjdWlzaW5lcztcclxuICAgIGZpbGxDdWlzaW5lc0hUTUwoKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCBjdWlzaW5lcyBIVE1MLlxyXG4gKi9cclxuZmlsbEN1aXNpbmVzSFRNTCA9IChjdWlzaW5lcyA9IHNlbGYuY3Vpc2luZXMpID0+IHtcclxuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0Jyk7XHJcblxyXG4gIGN1aXNpbmVzLmZvckVhY2goY3Vpc2luZSA9PiB7XHJcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgIG9wdGlvbi5pbm5lckhUTUwgPSBjdWlzaW5lO1xyXG4gICAgb3B0aW9uLnZhbHVlID0gY3Vpc2luZTtcclxuICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgR29vZ2xlIG1hcCwgY2FsbGVkIGZyb20gSFRNTC5cclxuICovXHJcbndpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xyXG4gIGxldCBsb2MgPSB7XHJcbiAgICBsYXQ6IDQwLjcyMjIxNixcclxuICAgIGxuZzogLTczLjk4NzUwMVxyXG4gIH07XHJcbiAgc2VsZi5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xyXG4gICAgem9vbTogMTIsXHJcbiAgICBjZW50ZXI6IGxvYyxcclxuICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxyXG4gIH0pO1xyXG5cclxuICBpZiAoc2VsZi5yZXN0YXVyYW50cykge1xyXG4gICAgYWRkTWFya2Vyc1RvTWFwKCk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVXBkYXRlIHBhZ2UgYW5kIG1hcCBmb3IgY3VycmVudCByZXN0YXVyYW50cy5cclxuICovXHJcbnVwZGF0ZVJlc3RhdXJhbnRzID0gKCkgPT4ge1xyXG4gIGNvbnN0IGNTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0Jyk7XHJcbiAgY29uc3QgblNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xyXG5cclxuICBjb25zdCBjSW5kZXggPSBjU2VsZWN0LnNlbGVjdGVkSW5kZXg7XHJcbiAgY29uc3QgbkluZGV4ID0gblNlbGVjdC5zZWxlY3RlZEluZGV4O1xyXG5cclxuICBjb25zdCBjdWlzaW5lID0gY1NlbGVjdFtjSW5kZXhdLnZhbHVlO1xyXG4gIGNvbnN0IG5laWdoYm9yaG9vZCA9IG5TZWxlY3RbbkluZGV4XS52YWx1ZTtcclxuXHJcbiAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kKGN1aXNpbmUsIG5laWdoYm9yaG9vZCwgKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgc2hvd05vdGlmaWNhdGlvbihlcnJvcik7XHJcbiAgICAgIGlmICghcmVzdGF1cmFudHMpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXNldFJlc3RhdXJhbnRzKHJlc3RhdXJhbnRzKTtcclxuICAgIGZpbGxSZXN0YXVyYW50c0hUTUwoKTtcclxuICAgIEhlbHBlci5sYXp5TG9hZCgpO1xyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDbGVhciBjdXJyZW50IHJlc3RhdXJhbnRzLCB0aGVpciBIVE1MIGFuZCByZW1vdmUgdGhlaXIgbWFwIG1hcmtlcnMuXHJcbiAqL1xyXG5yZXNldFJlc3RhdXJhbnRzID0gKHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgLy8gUmVtb3ZlIGFsbCByZXN0YXVyYW50c1xyXG4gIHNlbGYucmVzdGF1cmFudHMgPSBbXTtcclxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XHJcbiAgdWwuaW5uZXJIVE1MID0gJyc7XHJcblxyXG4gIC8vIFJlbW92ZSBhbGwgbWFwIG1hcmtlcnNcclxuICBzZWxmLm1hcmtlcnMuZm9yRWFjaChtID0+IG0uc2V0TWFwKG51bGwpKTtcclxuICBzZWxmLm1hcmtlcnMgPSBbXTtcclxuICBzZWxmLnJlc3RhdXJhbnRzID0gcmVzdGF1cmFudHM7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgYWxsIHJlc3RhdXJhbnRzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuZmlsbFJlc3RhdXJhbnRzSFRNTCA9IChyZXN0YXVyYW50cyA9IHNlbGYucmVzdGF1cmFudHMpID0+IHtcclxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XHJcblxyXG4gIGlmIChyZXN0YXVyYW50cy5sZW5ndGggPT09IDApIHtcclxuICAgIGNvbnN0IG5vUmVzdGF1cmFudHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgICBub1Jlc3RhdXJhbnRzLmlubmVySFRNTCA9IGBDb3VsZCBub3QgZmluZCBhbnkgcmVzdGF1cmFudHMgOihgO1xyXG4gICAgdWwuYXBwZW5kQ2hpbGQobm9SZXN0YXVyYW50cyk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xyXG4gICAgdWwuYXBwZW5kKGNyZWF0ZVJlc3RhdXJhbnRIVE1MKHJlc3RhdXJhbnQpKTtcclxuICB9KTtcclxuICAvL2FkZE1hcmtlcnNUb01hcCgpO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTC5cclxuICovXHJcbmNyZWF0ZVJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQpID0+IHtcclxuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcblxyXG4gIGNvbnN0IGltZ1NyYyA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCB0cnVlKTtcclxuICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XHJcbiAgaW1hZ2UuY2xhc3NMaXN0LmFkZCgnbGF6eScpO1xyXG4gIGltYWdlLnNyYyA9IGltZ1NyYztcclxuICBpbWFnZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3JjJywgREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpKTtcclxuICBpbWFnZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3Jjc2V0JywgREJIZWxwZXIuaW1hZ2VTUkNTZXRVcmxzRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBbJzF4JywgJzJ4J10pKTtcclxuICBpbWFnZS5hbHQgPSAocmVzdGF1cmFudC5waG90b2dyYXBoKSA/IERCSGVscGVyLmdldFBob3RvRGVzY3JpcHRpb24ocmVzdGF1cmFudCkgOlxyXG4gICdubyBwaWN0dXJlIGZvdW5kJztcclxuICBsaS5hcHBlbmQoaW1hZ2UpO1xyXG5cclxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcclxuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcclxuICBuYW1lLnRpdGxlID0gJ3Jlc3RhdXJhbnQgbmFtZSc7XHJcbiAgbGkuYXBwZW5kKG5hbWUpO1xyXG5cclxuICBjb25zdCBuZWlnaGJvcmhvb2QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgbmVpZ2hib3Job29kLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmVpZ2hib3Job29kO1xyXG4gIG5laWdoYm9yaG9vZC50aXRsZSA9ICdyZXN0YXVyYW50IG5laWdoYm9yaG9vZCc7XHJcbiAgbGkuYXBwZW5kKG5laWdoYm9yaG9vZCk7XHJcblxyXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XHJcbiAgYWRkcmVzcy50aXRsZSA9ICdyZXN0YXVyYW50IGFkZHJlc3MnO1xyXG4gIGxpLmFwcGVuZChhZGRyZXNzKTtcclxuXHJcbiAgY29uc3QgbW9yZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICBtb3JlLmlubmVySFRNTCA9IGBWaWV3IE1vcmUgYWJvdXQgJHtyZXN0YXVyYW50Lm5hbWV9YDtcclxuICBtb3JlLnRpdGxlID0gYE1vcmUgZGV0YWlscyBhYm91dCB0aGUgcmVzdHVyYW50ICR7cmVzdGF1cmFudC5uYW1lfWA7XHJcbiAgbW9yZS5ocmVmID0gREJIZWxwZXIudXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcclxuICBsaS5hcHBlbmQobW9yZSlcclxuXHJcbiAgcmV0dXJuIGxpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBZGQgbWFya2VycyBmb3IgY3VycmVudCByZXN0YXVyYW50cyB0byB0aGUgbWFwLlxyXG4gKi9cclxuYWRkTWFya2Vyc1RvTWFwID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xyXG4gIHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XHJcbiAgICAvLyBBZGQgbWFya2VyIHRvIHRoZSBtYXBcclxuICAgIGNvbnN0IG1hcmtlciA9IERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgc2VsZi5tYXApO1xyXG4gICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAnY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gbWFya2VyLnVybFxyXG4gICAgfSk7XHJcblxyXG4gICAgc2VsZi5tYXJrZXJzLnB1c2gobWFya2VyKTtcclxuICB9KTtcclxufVxyXG4iXX0=
